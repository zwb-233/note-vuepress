import{_ as k}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as t,a as s,d as l,b as a,e,f as h,r as p,o as d}from"./app-De620kUC.js";const r={};function g(c,i){const n=p("RouteLink");return d(),t("div",null,[i[5]||(i[5]=s("h1",{id:"makefile",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#makefile"},[s("span",null,"Makefile")])],-1)),s("ul",null,[i[2]||(i[2]=l('<li>GNU Make 官方网站：<a href="https://www.gnu.org/software/make/" target="_blank" rel="noopener noreferrer">https://www.gnu.org/software/make/</a></li><li>GNU Make 官方文档下载地址：<a href="https://www.gnu.org/software/make/manual/" target="_blank" rel="noopener noreferrer">https://www.gnu.org/software/make/manual/</a></li><li>Makefile Tutorial：<a href="https://makefiletutorial.com/" target="_blank" rel="noopener noreferrer">https://makefiletutorial.com/</a></li><li>写给初学者的 Makefile 指南：<a href="https://zhuanlan.zhihu.com/p/618350718" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/p/618350718</a></li><li>此md文件是对 Makefile 教程的改编：<a href="https://github.com/WohimLee/GNC-Tutorial" target="_blank" rel="noopener noreferrer">https://github.com/WohimLee/GNC-Tutorial</a></li>',5)),s("li",null,[i[1]||(i[1]=a("编译器部分见")),e(n,{to:"/C/c.html#gccg%E7%BC%96%E8%AF%91%E5%99%A8%E4%BD%BF%E7%94%A8"},{default:h(()=>i[0]||(i[0]=[a("GCC/G++编译器使用")])),_:1})])]),i[6]||(i[6]=l(`<h2 id="1-介绍" tabindex="-1"><a class="header-anchor" href="#1-介绍"><span>1. 介绍</span></a></h2><h3 id="10-make" tabindex="-1"><a class="header-anchor" href="#10-make"><span>1.0 make</span></a></h3><ul><li><p>make只是一个根据指定的Shell命令进行构建的工具。它的规则很简单，你规定要构建哪个文件、它依赖哪些源文件，当那些文件有变动时，如何重新构建它</p><ul><li>可以简单的使用make(将执行第一个目标)或者在make命令后带上目标名比如all</li><li>通过 -B 选项让所有目标总是重新建立</li><li>使用 -d 选项打印调试信息</li><li>使用 -C 选项改变目录</li><li>通过 -f 选项将其它文件看作 Makefile</li></ul></li><li><p>实现递归执行make：<code>\${make}</code>是官方定义的变量，用于得到执行make操作的make工具绝对路径，使用<code>make</code>命令</p><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 参数将传递给Makefile文件</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">MAKE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> -C 文件路径(默认为.) [参数]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="11-makefile-命令基本格式" tabindex="-1"><a class="header-anchor" href="#11-makefile-命令基本格式"><span>1.1 Makefile 命令基本格式</span></a></h3><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">targets</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> prerequisties</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">[tab键]command</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>target：目标文件，可以是 OjectFile，也可以是执行文件，还可以是一个标签（Label），对于标签这种特性，在后续的“伪目标”章节中会有叙述。</li><li>prerequisite：要生成那个 target 所需要的文件或是目标。</li><li>command：是 make 需要执行的命令，可以调用</li></ul><h3 id="12-makefile-规则" tabindex="-1"><a class="header-anchor" href="#12-makefile-规则"><span>1.2 Makefile 规则</span></a></h3><ul><li>make 会在当前目录下找到一个名字叫 <code>Makefile</code> 或 <code>makefile</code> 的文件</li><li>如果找到，它会找文件中第一个目标文件（target），并把这个文件作为最终的目标文件</li><li>如果 target 文件不存在，或是 target 文件依赖的 .o 文件(prerequities)的文件修改时间要比 target 这个文件新，就会执行后面所定义的命令 command 来生成 target 这个文件</li><li>如果 target 依赖的 .o 文件（prerequisties）也存在，make 会在当前文件中找到 target 为 .o 文件的依赖性，如果找到，再根据那个规则生成 .o 文件</li></ul><h3 id="13-伪目标" tabindex="-1"><a class="header-anchor" href="#13-伪目标"><span>1.3 伪目标</span></a></h3><ul><li>为了避免 target 和 Makefile 同级目录下 <code>文件/文件夹</code> 重名，文件未更新无法使用的情况，我们可以使用一个特殊的标记 <code>.PHONY</code> 来显式地指明一个目标是 &quot;伪目标&quot;，向 <code>make</code> 说明，不管是否有这个文件/文件夹，是否未更新都直接执行，这个目标就是 &quot;伪目标&quot;</li></ul><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">.PHONY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> clean</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>只要有这个声明，不管是否有 &quot;clean&quot; 文件/文件夹，都运行 &quot;clean&quot; 这个目标</li></ul><h3 id="14-引入mk文件" tabindex="-1"><a class="header-anchor" href="#14-引入mk文件"><span>1.4 引入mk文件</span></a></h3><ul><li>除了<code>Makefile</code>文件还可以创建其他的<code>.mk</code>结尾的文件，他们同样使用M<code>akefile</code>语法，主要用于重用，在对应的<code>Makefile</code>文件中使用<code>include</code>引入</li></ul><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">include</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> sub.mk</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 希望引入失败不报错，在部分make中使用sinclude才行</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">-include</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> sub.mk</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 之后可以这样检查是否引入成功</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">ifeq(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">wildcard</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sub.mk)</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">,)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="2-变量" tabindex="-1"><a class="header-anchor" href="#2-变量"><span>2. 变量</span></a></h2><ul><li>变量在声明时需要给予初值，而在使用时，需要给在变量名前加上 <code>$</code> 符号，并用括号 <code>()</code>/<code>{}</code> 把变量给包括起来</li></ul><h3 id="21-变量的定义" tabindex="-1"><a class="header-anchor" href="#21-变量的定义"><span>2.1 变量的定义</span></a></h3><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> src/main.cpp </span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">obj</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> objs/main.o</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="22-变量的引用" tabindex="-1"><a class="header-anchor" href="#22-变量的引用"><span>2.2 变量的引用</span></a></h3><ul><li>可以用 <code>()</code> 或 <code>{}</code></li></ul><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> src/main.cpp </span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">obj</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> objs/main.o</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">obj</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> : </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">\${</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> @g++ -c </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> -o </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">obj</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">compile</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">obj</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="23-预定义变量" tabindex="-1"><a class="header-anchor" href="#23-预定义变量"><span>2.3 预定义变量</span></a></h3><ul><li><code>$@</code>: 目标(target)的完整名称</li><li><code>$&lt;</code>: 第一个依赖文件（prerequisties）的名称</li><li><code>$^</code>: 所有的依赖文件（prerequisties），以空格分开，不包含重复的依赖文件</li><li><code>$?</code>: 代表所有比目标更新的依赖文件（prerequisties）名称</li><li><code>$*</code>: 代表目标(target)文件名中去掉后缀的部分</li></ul><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> src/main.cpp </span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">obj</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> objs/main.o</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">obj</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> : </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">\${</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> @g++ -c </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">$&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> -o </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">$@</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> @echo </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">$^</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">compile</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">obj</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">.PHONY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> compile</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="24-命令变量" tabindex="-1"><a class="header-anchor" href="#24-命令变量"><span>2.4 命令变量</span></a></h3><ul><li>在 <code>Makefile</code> 中，你可以定义和使用类似函数的东西，称为 &quot;命令序列&quot; 或 &quot;命令块&quot;</li><li>虽然没有传统编程语言中的函数和参数传递机制，但你可以通过定义命令块并使用 <code>call</code> 函数执行和传递参数</li><li>命令前可以使用制表符或空格</li><li>不能放到循环中执行</li></ul><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 定义多行命令序列</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">define</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> compile_command</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CC</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CFLAGS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> -c </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">$&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> -o </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">$@</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">endef</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 定义命令块函数，使用call执行命令</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">define</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> compile_command</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">@echo &quot;Compiling </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">...&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CC</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CFLAGS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> -c </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> -o </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">endef</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">call</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> compile_command,</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">$&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">,</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">$@</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="3-makefile-常用符号" tabindex="-1"><a class="header-anchor" href="#3-makefile-常用符号"><span>3. Makefile 常用符号</span></a></h2><h3 id="31" tabindex="-1"><a class="header-anchor" href="#31"><span>3.1 =</span></a></h3><ul><li>简单的赋值运算符</li><li>用于将右边的值分配给左边的变量</li><li><strong>变量的值是整个makefile中最后被指定的值</strong></li></ul><blockquote><p>示例</p></blockquote><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">HOST_ARCH</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">   =</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> aarch64</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">TARGET_ARCH</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">HOST_ARCH</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 更改了变量 a</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">HOST_ARCH</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">   =</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> amd64</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">debug</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> @echo </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">TARGET_ARCH</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="32" tabindex="-1"><a class="header-anchor" href="#32"><span>3.2 :=</span></a></h3><ul><li>立即赋值运算符</li><li>用于在定义变量时立即求值</li><li>赋予当前位置时对应的值</li></ul><blockquote><p>示例</p></blockquote><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">HOST_ARCH</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">   :=</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> aarch64</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">TARGET_ARCH</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">HOST_ARCH</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 更改了变量 a</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">HOST_ARCH</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> amd64</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">debug</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> @echo </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">TARGET_ARCH</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="33" tabindex="-1"><a class="header-anchor" href="#33"><span>3.3 ?=</span></a></h3><ul><li>默认赋值运算符</li><li>如果该变量已经定义，则不进行任何操作</li><li>如果该变量尚未定义，则求值并分配</li></ul><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">HOST_ARCH</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  =</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> aarch64</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">HOST_ARCH</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ?=</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> amd64</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">debug</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">    @echo </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">HOST_ARCH</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="34-累加" tabindex="-1"><a class="header-anchor" href="#34-累加"><span>3.4 累加 +=</span></a></h3><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CXXFLAGS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> -m64 -fPIC -g -O0 -std=c++11 -w -fopenmp</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CXXFLAGS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> +=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">include_paths</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="35" tabindex="-1"><a class="header-anchor" href="#35"><span>3.5 \\</span></a></h3><ul><li>续行符</li></ul><blockquote><p>示例</p></blockquote><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">LDLIBS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> cudart opencv_core </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">          gomp nvinfer protobuf cudnn pthread </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">          cublas nvcaffe_parser nvinfer_plugin</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="36-与" tabindex="-1"><a class="header-anchor" href="#36-与"><span>3.6 * 与 %</span></a></h3><ul><li><code>*</code>: 通配符表示匹配任意字符串，可以用在目录名或文件名中</li><li><code>%</code>: 通配符表示匹配任意字符串，并将匹配到的字符串作为变量使用</li></ul><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># %.o 的作用是匹配所有以 .o 结尾的目标</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 而后面的 %.c 中 % 的作用，则是将 %.o 中 % 的内容拿过来用</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">.o</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> %</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">.c</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">        gcc -c </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">INCS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> $&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> -o </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">$@</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="4-makefile-的常用函数" tabindex="-1"><a class="header-anchor" href="#4-makefile-的常用函数"><span>4. Makefile 的常用函数</span></a></h2><p>函数调用，很像变量的使用，也是以 “$” 来标识的，其语法如下：</p><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">fn, arguments</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> or </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">\${</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">fn, arguments</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>fn: 函数名</li><li>arguments: 函数参数，参数间以逗号 <code>,</code> 分隔，而函数名和参数之间以“空格”分隔</li></ul><h3 id="41-shell" tabindex="-1"><a class="header-anchor" href="#41-shell"><span>4.1 shell</span></a></h3><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">shell</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &lt;command&gt; &lt;arguments&gt;)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>名称：shell 命令函数 —— shell</li><li>功能：调用 shell 命令 command</li><li>返回：函数返回 shell 命令 command 的执行结果</li></ul><blockquote><p>示例：</p></blockquote><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># shell 指令，src 文件夹下找到 .cpp 文件</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp_srcs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">shell</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> find src -name &quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.cpp&quot;)</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># shell 指令, 获取计算机架构</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">HOST_ARCH</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">shell</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> uname -m)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="42-subst" tabindex="-1"><a class="header-anchor" href="#42-subst"><span>4.2 subst</span></a></h3><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">subst</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &lt;from&gt;,&lt;to&gt;,&lt;text&gt;)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>名称：字符串替换函数——subst</li><li>功能：把字串 &lt;text&gt; 中的 &lt;from&gt; 字符串替换成 &lt;to&gt;</li><li>返回：函数返回被替换过后的字符串</li></ul><blockquote><p>示例：</p></blockquote><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp_srcs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">shell</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> find src -name &quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.cpp&quot;)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp_objs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">subst</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> src/,objs/,$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp_srcs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">))</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="43-patsubst" tabindex="-1"><a class="header-anchor" href="#43-patsubst"><span>4.3 patsubst</span></a></h3><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">patsubst</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &lt;pattern&gt;,&lt;replacement&gt;,&lt;text&gt;)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>名称：模式字符串替换函数 —— patsubst</li><li>功能：通配符 <code>%</code>，表示任意长度的字串，从 text 中取出 patttern， 替换成 replacement</li><li>返回：函数返回被替换过后的字符串</li></ul><blockquote><p>示例：</p></blockquote><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp_srcs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">shell</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> find src -name &quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.cpp&quot;)</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> #shell指令，src文件夹下找到.cpp文件</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp_objs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">patsubst</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> %</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.cpp,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.o,$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp_srcs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">))</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> #cpp_srcs变量下cpp文件替换成 .o文件</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="44-foreach" tabindex="-1"><a class="header-anchor" href="#44-foreach"><span>4.4 foreach</span></a></h3><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">foreach</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &lt;var&gt;,&lt;list&gt;,&lt;text&gt;)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>名称：循环函数——foreach。</li><li>功能：把字串&lt;list&gt;中的元素逐一取出来，执行&lt;text&gt;包含的表达式</li><li>返回：&lt;text&gt;所返回的每个字符串所组成的整个字符串（以空格分隔）</li></ul><blockquote><p>示例：</p></blockquote><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">library_paths</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> /datav/shared/100_du/03.08/lean/protobuf-3.11.4/lib </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">                 /usr/local/cuda-10.1/lib64</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">library_paths</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">foreach</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> item,$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">library_paths</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">),-L$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">item</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">))</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>同等效果</p></blockquote><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 相当于foreach和subst/patsubst的结合</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># subst的例子, 用 .o 替换 .c, $(SRCS:.c=.o)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">I_flag</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">include_paths:%=-I%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="45-dir" tabindex="-1"><a class="header-anchor" href="#45-dir"><span>4.5 dir</span></a></h3><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">dir</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &lt;names...&gt;)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>名称：取目录函数——dir。</li><li>功能：从文件名序列names中取出目录部分。目录部分是指最后一个反斜杠（“/”）之前 的部分。如果没有反斜杠，那么返回“./”。</li><li>返回：返回文件名序列names的目录部分。</li></ul><blockquote><p>示例：</p></blockquote><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">dir</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> src/foo.c hacks)</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 返回值是“src/ ./”。</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="46-notdir" tabindex="-1"><a class="header-anchor" href="#46-notdir"><span>4.6 notdir</span></a></h3><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">notdir</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &lt;names...&gt;)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>用于从给定的路径中提取文件名部分</li></ul><blockquote><p>示例：</p></blockquote><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">libs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">   :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">notdir</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">shell</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> find /usr/lib -name lib</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">))</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="47-filter" tabindex="-1"><a class="header-anchor" href="#47-filter"><span>4.7 filter</span></a></h3><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">filter</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &lt;names...&gt;)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>用于从一个字符串列表中筛选出符合指定条件的结果</li></ul><blockquote><p>示例：</p></blockquote><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">libs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">notdir</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">shell</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> find /usr/lib -name lib</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">))</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">a_libs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">filter</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> %</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.a,$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">libs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">))</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">so_libs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">filter</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> %</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.so,$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">libs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">))</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="48-basename" tabindex="-1"><a class="header-anchor" href="#48-basename"><span>4.8 basename</span></a></h3><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">basename</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &lt;names...&gt;)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>名称：取前缀函数——basename。</li><li>语法：$(basename &lt;names...&gt;)</li><li>功能：从文件名序列 &lt;names&gt; 中取出各个文件名的前缀部分。</li><li>返回：返回文件名序列 &lt;names&gt; 的前缀序列，如果文件没有前缀，则返回空字串。</li></ul><blockquote><p>示例：</p></blockquote><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">libs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">notdir</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">shell</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> find /usr/lib -name lib</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">))</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">a_libs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">subst</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> lib,,$(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">basename</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">filter</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> %</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.a,$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">libs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">))))</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">so_libs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">subst</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> lib,,$(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">basename</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">filter</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> %</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.so,$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">libs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">))))</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="49-filter-out" tabindex="-1"><a class="header-anchor" href="#49-filter-out"><span>4.9 filter-out</span></a></h3><ul><li>剔除不想要的字符串</li></ul><blockquote><p>示例：</p></blockquote><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">objs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> objs/add.o objs/minus.o objs/main.o</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp_objs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">filter-out</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> objs/main.o, $(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">objs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">))</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="410-wildcard" tabindex="-1"><a class="header-anchor" href="#410-wildcard"><span>4.10 wildcard</span></a></h3><ul><li>让通配符自动展开成字符串列表</li></ul><blockquote><p>示例：</p></blockquote><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp_srcs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">wildcard</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> src/</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.cc src/</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.cpp src/</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.c)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 如果路径中没有匹配文件，返回空字符串</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="5-条件规则" tabindex="-1"><a class="header-anchor" href="#5-条件规则"><span>5. 条件规则</span></a></h2><blockquote><p>注意：</p></blockquote><ul><li>不在target中的ondition 语句里面全部不能用 Tab 缩进, 你看到的 Makefile 如果好像有 &quot;Tab&quot;, 那全部是空格</li><li>使用 Tab 会报错：*** commands commence before first target</li></ul><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">ifeq</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> (</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">DEBUG</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">, 1)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 使用空格缩进</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    common</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">+=</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">-DDEBUG</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">endif</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">all</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">    mkdir -p exec</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">ifeq</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> (</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">NEEDOBJ</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">,1)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 作为all命令的一部分，tab缩进</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">    mkdir -p obj</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">endif</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="51-ifeq-else-endif" tabindex="-1"><a class="header-anchor" href="#51-ifeq-else-endif"><span>5.1 ifeq / else / endif</span></a></h3><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># build flags</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">ifeq</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> (</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">TARGET_OS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">,darwin)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    LDFLAGS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> +=</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> -rpath </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CUDA_PATH</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">/lib</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    CCFLAGS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> +=</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> -arch </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">HOST_ARCH</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">else ifeq</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> (</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">HOST_ARCH</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">-</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">TARGET_ARCH</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">-</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">TARGET_OS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">,x86_64-armv7l-linux)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    LDFLAGS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> +=</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> --dynamic-linker=/lib/ld-linux-armhf.so.3</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    CCFLAGS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> +=</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> -mfloat-abi=hard</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">else ifeq</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> (</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">TARGET_OS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">,android)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    LDFLAGS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> +=</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> -pie</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    CCFLAGS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> +=</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> -fpie -fpic -fexceptions</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">endif</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="52-ifneq-else-endif" tabindex="-1"><a class="header-anchor" href="#52-ifneq-else-endif"><span>5.2 ifneq / else / endif</span></a></h3><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">HOST_ARCH</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">   :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">shell</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> uname -m)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">TARGET_ARCH</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ?=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">HOST_ARCH</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">temp</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">filter</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">TARGET_ARCH</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">),x86_64 aarch64 sbsa ppc64le armv7l)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">ifneq</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> (,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">filter</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">TARGET_ARCH</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">),x86_64 aarch64 sbsa ppc64le armv7l)</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    ifneq</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> (</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">TARGET_ARCH</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">HOST_ARCH</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        ifneq</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> (,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">filter</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">TARGET_ARCH</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">),x86_64 aarch64 sbsa ppc64le)</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">            TARGET_SIZE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> 64</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        else ifneq</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> (,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">filter</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">TARGET_ARCH</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">),armv7l)</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">            TARGET_SIZE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> 32</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        endif</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    else</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">        TARGET_SIZE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">shell</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> getconf LONG_BIT)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    endif</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">else</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">error</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ERROR - unsupported value $(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">TARGET_ARCH</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">) for TARGET_ARCH!)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">endif</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="53-ifdef-else-endif" tabindex="-1"><a class="header-anchor" href="#53-ifdef-else-endif"><span>5.3 ifdef / else / endif</span></a></h3><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">ifdef</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> TARGET_OVERRIDE </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># cuda toolkit targets override</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    NVCCFLAGS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> +=</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> -target-dir </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">TARGET_OVERRIDE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">endif</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="54-关于循环" tabindex="-1"><a class="header-anchor" href="#54-关于循环"><span>5.4 关于循环</span></a></h3><blockquote><p>注：循环在Makefile中基本上用不上，在这里仅做基本的用法整理</p></blockquote><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 可以利用换行符优化排版</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 其中命令无法使用@取消消息显示，本身消息可以通过@for取消</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 不能与定义的命令变量一起使用，无法识别$(call)方法</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 遍历变量</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">for item in </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">value_list</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">; do echo </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">$$</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">item; echo endl; done</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">@</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">foreach</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> x, $(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">list</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">),echo &#39;===&gt; &#39; </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">$x</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">;)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 遍历指定次数</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 测试失败，值不变</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">couter</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:=</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">@while [ </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">counter</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> -lt 5 ]; do \\</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    echo</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> &quot;Counter</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">counter</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">&quot;; </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    counter=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">$$</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(expr </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">counter</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> + 1); </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">done</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>另外:使用循环时,比如<code>@$(foreach item, $(items), $(echo $(item));)</code>，但是<strong>千万记得添加<code>;</code></strong>，不然<code>make</code>会将多条命令拼接在一起再执行，命令结果肯定是不对的</li><li>而且要注意如果是目标中的指令，出现在这里的最终必须是命令行的命令，而不是变量</li></ul><h2 id="6-编译" tabindex="-1"><a class="header-anchor" href="#6-编译"><span>6. 编译</span></a></h2><h3 id="61-编译过程" tabindex="-1"><a class="header-anchor" href="#61-编译过程"><span>6.1 编译过程</span></a></h3><h4 id="611-预处理" tabindex="-1"><a class="header-anchor" href="#611-预处理"><span>6.1.1 预处理</span></a></h4><blockquote><p>示例</p></blockquote><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp_srcs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">shell</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> find src -name &quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.cpp&quot;)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">pp_files</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">patsubst</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> src/</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.cpp,src/</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.i,$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp_srcs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">src/</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">.i</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> src/</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">.cpp</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> @g++ -E </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">$^</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> -o </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">$@</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">preprocess</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">pp_files</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">clean</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> @rm -f src/*.i</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">debug</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> @echo </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">pp_files</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">.PHONY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> debug preprocess clean</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="612-编译成汇编语言" tabindex="-1"><a class="header-anchor" href="#612-编译成汇编语言"><span>6.1.2 编译成汇编语言</span></a></h4><blockquote><p>示例</p></blockquote><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp_srcs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">shell</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> find src -name &quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.cpp&quot;)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">as_files</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">patsubst</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> src/</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.cpp,src/</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.s,$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp_srcs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">src/</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">.s</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> src/</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">.cpp</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> @g++ -S </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">$^</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> -o </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">$@</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">assemble</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">as_files</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">clean</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> @rm -f src/*.s</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">debug</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> @echo </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">as_files</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">.PHONY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> debug assemble clean</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="613-编译成目标文件" tabindex="-1"><a class="header-anchor" href="#613-编译成目标文件"><span>6.1.3 编译成目标文件</span></a></h4><blockquote><p>示例</p></blockquote><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp_srcs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">shell</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> find src -name &quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.cpp&quot;)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp_objs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">patsubst</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> src/</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.cpp,objs/</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.o,$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp_srcs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">objs/</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">.o</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> src/</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">.cpp</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> @mkdir -p </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">dir</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> $@</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> @g++ -c </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">$^</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> -o </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">$@</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">objects</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp_objs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">clean</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> @rm -rf objs src/*.o</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">debug</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> @echo </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">as_files</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">.PHONY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> debug objects clean</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="614-链接可执行文件" tabindex="-1"><a class="header-anchor" href="#614-链接可执行文件"><span>6.1.4 链接可执行文件</span></a></h4><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp_srcs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">shell</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> find src -name &quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.cpp&quot;)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp_objs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">patsubst</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> src/</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.cpp,objs/</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.o,$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp_srcs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">))</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">objs/</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">.o</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> src/</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">.cpp</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> @mkdir -p </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">dir</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> $@</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> @g++ -c </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">$^</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> -o </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">$@</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">workspace/exec</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp_objs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> @mkdir workspace/exec</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> @g++ </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">$^</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> -o </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">$@</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">run</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> workspace</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> @./</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">$&lt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">clean</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> @rm -rf objs workspace/exec</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">debug</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> @echo </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">as_files</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">.PHONY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> debug run clean</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="62-编译选项" tabindex="-1"><a class="header-anchor" href="#62-编译选项"><span>6.2 编译选项</span></a></h3>`,131)),s("ul",null,[s("li",null,[i[4]||(i[4]=a("见")),e(n,{to:"/C/c.html#%E5%8F%AF%E7%94%A8%E9%80%89%E9%A1%B9"},{default:h(()=>i[3]||(i[3]=[a("GCC/G++可用选项")])),_:1})])]),i[7]||(i[7]=l(`<h3 id="63-implicit-rules" tabindex="-1"><a class="header-anchor" href="#63-implicit-rules"><span>6.3 Implicit Rules</span></a></h3><ul><li>CC: Program for compiling C programs; default cc</li><li>CXX: Program for compiling C++ programs; default g++</li><li>CFLAGS: Extra flags to give to the C compiler</li><li>CXXFLAGS: Extra flags to give to the C++ compiler</li><li>CPPFLAGS: Extra flags to give to the C preprocessor</li><li>LDFLAGS: Extra flags to give to compilers when they are supposed to invoke the linker</li></ul><h3 id="64-编译带头文件的程序" tabindex="-1"><a class="header-anchor" href="#64-编译带头文件的程序"><span>6.4 编译带头文件的程序</span></a></h3><blockquote><p>add.hpp</p></blockquote><div class="language-c++ line-numbers-mode" data-highlighter="shiki" data-ext="c++" data-title="c++" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#ifndef</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> ADD_HPP</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> ADD_HPP</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> add</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> a</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> b</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#endif</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // ADD_HPP</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>add.cpp</p></blockquote><div class="language-c++ line-numbers-mode" data-highlighter="shiki" data-ext="c++" data-title="c++" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> add</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> a</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> b</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> a</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">+</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">b;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>minus.hpp</p></blockquote><div class="language-c++ line-numbers-mode" data-highlighter="shiki" data-ext="c++" data-title="c++" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#ifndef</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> MINUS_HPP</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> MINUS_HPP</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> minus</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> a</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> b</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#endif</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // MINUS_HPP</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>minus.cpp</p></blockquote><div class="language-c++ line-numbers-mode" data-highlighter="shiki" data-ext="c++" data-title="c++" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> minus</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> a</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> b</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> a</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">b;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>main.cpp</p></blockquote><div class="language-c++ line-numbers-mode" data-highlighter="shiki" data-ext="c++" data-title="c++" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &lt;stdio.h&gt;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;add.hpp&quot;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;minus.hpp&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> main</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    int</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> a</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> b</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    int</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> res </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> add</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(a, b);</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    printf</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;a + b = </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%d</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, res);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    res </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> minus</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(a, b);</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    printf</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;a - b = </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%d</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, res);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>Makefile</p></blockquote><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp_srcs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">shell</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> find src -name &quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.cpp&quot;)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp_objs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">patsubst</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> src/</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.cpp,objs/</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.o,$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp_srcs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 你的头文件所在文件夹路径（建议绝对路径）</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">include_paths</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> </span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">I_flag</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">include_paths:%=-I%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">objs/</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">.o</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> src/</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">.cpp</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> @mkdir -p </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">dir</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> $@</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> @g++ -c </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">$^</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> -o </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">$@</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">I_flag</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">workspace/exec</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp_objs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> @mkdir -p </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">dir</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> $@</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> @g++ </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">$^</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> -o </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">$@</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">run</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> workspace/exec</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> @./</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">$&lt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">debug</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> @echo </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">I_flag</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">clean</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> @rm -rf objs</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">.PHONY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> debug run</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="7-特殊变量" tabindex="-1"><a class="header-anchor" href="#7-特殊变量"><span>7. 特殊变量</span></a></h2><h3 id="71-vpath" tabindex="-1"><a class="header-anchor" href="#71-vpath"><span>7.1 VPATH</span></a></h3><ul><li><code>VPATH</code>用于指定依赖文件的搜索路径。如果在当前目录中找不到依赖文件，<code>make</code>将在<code>VPATH</code>变量定义的路径中搜索，目录之间使用<code>:</code>分隔</li><li>可用于帮助目标<code>obj/%.o: %.c</code>搜索对应的文件夹下的源文件</li></ul><h2 id="常见-error" tabindex="-1"><a class="header-anchor" href="#常见-error"><span>常见 Error</span></a></h2><blockquote><p>*** missing separator. Stop.</p></blockquote><ul><li>原因: Makefile 语法出错</li><li>解决方法: 根据报错的行数，检查 tab 缩进，空格问题</li><li>如果是目标中的逐条指令应该使用tab缩进而非空格</li></ul><blockquote><p>*** commands commence before first target. Stop</p></blockquote><ul><li>原因: 在非目标中的if等语句里面用了 tab 缩进</li><li>解决方法: 缩进的地方全部改为空格</li></ul><blockquote><p>*** recipe commences before first target.</p></blockquote><ul><li>原因：在指令前使用了空格和tab缩进一起使用的情况，或在换行符<code>/</code>之后又跟了空格</li><li>解决方法：在报错行附近检查空格的使用情况</li></ul>`,25))])}const o=k(r,[["render",g],["__file","make.html.vue"]]),u=JSON.parse('{"path":"/note/skill/make.html","title":"Makefile","lang":"zh-CN","frontmatter":{"description":"Makefile GNU Make 官方网站：https://www.gnu.org/software/make/ GNU Make 官方文档下载地址：https://www.gnu.org/software/make/manual/ Makefile Tutorial：https://makefiletutorial.com/ 写给初学者的 Make...","head":[["meta",{"property":"og:url","content":"https://zwb233.github.io/note-vuepress/note-vuepress/note/skill/make.html"}],["meta",{"property":"og:site_name","content":"博客演示"}],["meta",{"property":"og:title","content":"Makefile"}],["meta",{"property":"og:description","content":"Makefile GNU Make 官方网站：https://www.gnu.org/software/make/ GNU Make 官方文档下载地址：https://www.gnu.org/software/make/manual/ Makefile Tutorial：https://makefiletutorial.com/ 写给初学者的 Make..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Makefile\\",\\"image\\":[\\"\\"],\\"dateModified\\":null,\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"12a\\",\\"url\\":\\"/note-vuepress/intro.html\\"}]}"]]},"headers":[{"level":2,"title":"1. 介绍","slug":"1-介绍","link":"#1-介绍","children":[{"level":3,"title":"1.0 make","slug":"10-make","link":"#10-make","children":[]},{"level":3,"title":"1.1 Makefile 命令基本格式","slug":"11-makefile-命令基本格式","link":"#11-makefile-命令基本格式","children":[]},{"level":3,"title":"1.2 Makefile 规则","slug":"12-makefile-规则","link":"#12-makefile-规则","children":[]},{"level":3,"title":"1.3 伪目标","slug":"13-伪目标","link":"#13-伪目标","children":[]},{"level":3,"title":"1.4 引入mk文件","slug":"14-引入mk文件","link":"#14-引入mk文件","children":[]}]},{"level":2,"title":"2. 变量","slug":"2-变量","link":"#2-变量","children":[{"level":3,"title":"2.1 变量的定义","slug":"21-变量的定义","link":"#21-变量的定义","children":[]},{"level":3,"title":"2.2 变量的引用","slug":"22-变量的引用","link":"#22-变量的引用","children":[]},{"level":3,"title":"2.3 预定义变量","slug":"23-预定义变量","link":"#23-预定义变量","children":[]},{"level":3,"title":"2.4 命令变量","slug":"24-命令变量","link":"#24-命令变量","children":[]}]},{"level":2,"title":"3. Makefile 常用符号","slug":"3-makefile-常用符号","link":"#3-makefile-常用符号","children":[{"level":3,"title":"3.1 =","slug":"31","link":"#31","children":[]},{"level":3,"title":"3.2 :=","slug":"32","link":"#32","children":[]},{"level":3,"title":"3.3 ?=","slug":"33","link":"#33","children":[]},{"level":3,"title":"3.4 累加 +=","slug":"34-累加","link":"#34-累加","children":[]},{"level":3,"title":"3.5 \\\\","slug":"35","link":"#35","children":[]},{"level":3,"title":"3.6 * 与 %","slug":"36-与","link":"#36-与","children":[]}]},{"level":2,"title":"4. Makefile 的常用函数","slug":"4-makefile-的常用函数","link":"#4-makefile-的常用函数","children":[{"level":3,"title":"4.1 shell","slug":"41-shell","link":"#41-shell","children":[]},{"level":3,"title":"4.2 subst","slug":"42-subst","link":"#42-subst","children":[]},{"level":3,"title":"4.3 patsubst","slug":"43-patsubst","link":"#43-patsubst","children":[]},{"level":3,"title":"4.4 foreach","slug":"44-foreach","link":"#44-foreach","children":[]},{"level":3,"title":"4.5 dir","slug":"45-dir","link":"#45-dir","children":[]},{"level":3,"title":"4.6 notdir","slug":"46-notdir","link":"#46-notdir","children":[]},{"level":3,"title":"4.7 filter","slug":"47-filter","link":"#47-filter","children":[]},{"level":3,"title":"4.8 basename","slug":"48-basename","link":"#48-basename","children":[]},{"level":3,"title":"4.9 filter-out","slug":"49-filter-out","link":"#49-filter-out","children":[]},{"level":3,"title":"4.10 wildcard","slug":"410-wildcard","link":"#410-wildcard","children":[]}]},{"level":2,"title":"5. 条件规则","slug":"5-条件规则","link":"#5-条件规则","children":[{"level":3,"title":"5.1 ifeq / else / endif","slug":"51-ifeq-else-endif","link":"#51-ifeq-else-endif","children":[]},{"level":3,"title":"5.2 ifneq / else / endif","slug":"52-ifneq-else-endif","link":"#52-ifneq-else-endif","children":[]},{"level":3,"title":"5.3 ifdef / else / endif","slug":"53-ifdef-else-endif","link":"#53-ifdef-else-endif","children":[]},{"level":3,"title":"5.4 关于循环","slug":"54-关于循环","link":"#54-关于循环","children":[]}]},{"level":2,"title":"6. 编译","slug":"6-编译","link":"#6-编译","children":[{"level":3,"title":"6.1 编译过程","slug":"61-编译过程","link":"#61-编译过程","children":[]},{"level":3,"title":"6.2 编译选项","slug":"62-编译选项","link":"#62-编译选项","children":[]},{"level":3,"title":"6.3 Implicit Rules","slug":"63-implicit-rules","link":"#63-implicit-rules","children":[]},{"level":3,"title":"6.4 编译带头文件的程序","slug":"64-编译带头文件的程序","link":"#64-编译带头文件的程序","children":[]}]},{"level":2,"title":"7. 特殊变量","slug":"7-特殊变量","link":"#7-特殊变量","children":[{"level":3,"title":"7.1 VPATH","slug":"71-vpath","link":"#71-vpath","children":[]}]},{"level":2,"title":"常见 Error","slug":"常见-error","link":"#常见-error","children":[]}],"readingTime":{"minutes":10.78,"words":3234},"filePathRelative":"note/skill/make.md","excerpt":"\\n<ul>\\n<li>GNU Make 官方网站：<a href=\\"https://www.gnu.org/software/make/\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">https://www.gnu.org/software/make/</a></li>\\n<li>GNU Make 官方文档下载地址：<a href=\\"https://www.gnu.org/software/make/manual/\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">https://www.gnu.org/software/make/manual/</a></li>\\n<li>Makefile Tutorial：<a href=\\"https://makefiletutorial.com/\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">https://makefiletutorial.com/</a></li>\\n<li>写给初学者的 Makefile 指南：<a href=\\"https://zhuanlan.zhihu.com/p/618350718\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">https://zhuanlan.zhihu.com/p/618350718</a></li>\\n<li>此md文件是对 Makefile 教程的改编：<a href=\\"https://github.com/WohimLee/GNC-Tutorial\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">https://github.com/WohimLee/GNC-Tutorial</a></li>\\n<li>编译器部分见<a href=\\"/note-vuepress/C/c.html#gccg%E7%BC%96%E8%AF%91%E5%99%A8%E4%BD%BF%E7%94%A8\\" target=\\"_blank\\">GCC/G++编译器使用</a></li>\\n</ul>","autoDesc":true}');export{o as comp,u as data};
